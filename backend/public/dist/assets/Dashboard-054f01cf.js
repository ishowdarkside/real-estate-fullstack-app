import{r as u,G as b,b as g,u as v,j as o,S as f}from"./index-0e1f805a.js";import{c as x,l as M,a as C,M as L,T as y,b as m,L as _}from"./TileLayer-1af8fba1.js";import{u as j}from"./useGetPosts-8083d829.js";import"./posts-b5afee41.js";const N=x(function(t,s){const i=new M.Popup(t,s.overlayContainer);return C(i,s)},function(t,s,{position:i},c){u.useEffect(function(){const{instance:n}=t;function r(p){p.popup===n&&(n.update(),c(!0))}function d(p){p.popup===n&&c(!1)}return s.map.on({popupopen:r,popupclose:d}),s.overlayContainer==null?(i!=null&&n.setLatLng(i),n.openOn(s.map)):s.overlayContainer.bindPopup(n),function(){var h;s.map.off({popupopen:r,popupclose:d}),(h=s.overlayContainer)==null||h.unbindPopup(),s.map.removeLayer(n)}},[t,s,c,i])}),P="_dashboardBody_1cho2_1",A="_mapContainer_1cho2_6",k="_buildingModal_1cho2_12",S="_showModal_1cho2_47",w="_generalInfo_1cho2_51",B="_info_1cho2_69",D="_price_1cho2_86",z="_buttonAdvanced_1cho2_95",E="_closeModal_1cho2_110",I="_headerDashboard_1cho2_127",O="_description_1cho2_146",T="_subtitle_1cho2_150",a={dashboardBody:P,mapContainer:A,buildingModal:k,showModal:S,generalInfo:w,info:B,price:D,buttonAdvanced:z,closeModal:E,headerDashboard:I,description:O,subtitle:T};function $(e){return b({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm165.4 618.2l-66-.3L512 563.4l-99.3 118.4-66.1.3c-4.4 0-8-3.5-8-8 0-1.9.7-3.7 1.9-5.2l130.1-155L340.5 359a8.32 8.32 0 0 1-1.9-5.2c0-4.4 3.6-8 8-8l66.1.3L512 464.6l99.3-118.4 66-.3c4.4 0 8 3.5 8 8 0 1.9-.7 3.7-1.9 5.2L553.5 514l130 155c1.2 1.5 1.9 3.3 1.9 5.2 0 4.4-3.6 8-8 8z"}}]})(e)}function F(){const{activeBuilding:e,setActiveBuilding:t}=g(),{data:s,isLoading:i}=j(),c=e&&e.join(","),l=v();if(i)return o.jsx(f,{});const n=e&&(s==null?void 0:s.posts.find(r=>r.coords[0]===c));return o.jsx("div",{className:`${a.buildingModal} ${e?a.showModal:""}`,children:n&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:a.closeModal,onClick:()=>t(null),children:o.jsx($,{})}),o.jsx("img",{src:`/${n.imgs[0]}`}),o.jsxs("div",{className:a.generalInfo,children:[o.jsx("span",{children:n.tipNekretnine}),o.jsx("span",{children:n.vrstaOglasa}),o.jsxs("span",{children:[o.jsx("img",{src:"/pin.svg"}),n.location]})]}),o.jsxs("div",{className:a.info,children:[o.jsx("h2",{children:n.title}),o.jsx("span",{className:a.subtitle,children:[n.subtitle]}),o.jsxs("span",{className:a.price,children:[n.price.toLocaleString("en-US")," KM"]}),o.jsx("span",{className:a.description,children:n.description})]}),o.jsx("button",{className:a.buttonAdvanced,onClick:()=>l(`/app/post/${n._id}`),children:"DETALJNO"})]})})}const G=new _.icon({iconUrl:"/building-black.svg",iconSize:[32,32]}),U=new _.icon({iconUrl:"/map-pin-line-fill.svg",iconSize:[32,32]});function V(){const[e,t]=u.useState([44.5375,18.6735]),{data:s,isLoading:i}=j(),{setActiveBuilding:c}=g();if(u.useEffect(()=>{navigator.geolocation.getCurrentPosition(n=>{const r=n.coords.latitude,d=n.coords.longitude;t([r,d])})},[]),i)return o.jsx(f,{});const l=s.posts.map(n=>n.coords[0].split(",").map(parseFloat));return o.jsxs("div",{className:a.mapContainer,children:[o.jsxs("div",{className:a.headerDashboard,children:[o.jsx("h1",{children:"MOJDOM"}),o.jsx("span",{children:"TraÅ¾i nekretnine po mapi"})]}),o.jsx("div",{id:"map",children:o.jsxs(L,{center:e,zoom:14,zoomControl:!1,scrollWheelZoom:!0,style:{height:"90dvh",width:"100%",position:"absolute",left:0},children:[o.jsx(y,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png'"}),o.jsx(m,{position:e,icon:U,eventHandlers:{click:n=>{console.log("marker clicked",n)}},children:o.jsx(N,{children:"Vi ste ovdje"})}),l.map(n=>o.jsx(m,{position:n,icon:G,eventHandlers:{click:()=>c(n)}},n))]})}),o.jsx(F,{})]})}export{V as default};
