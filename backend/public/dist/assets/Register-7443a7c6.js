import{u as h,n as d,j as e,S as u,L as w,H as S,r as _}from"./index-0e1f805a.js";import{u as v,L as y}from"./index.esm-c30642fc.js";import{s as N}from"./storeCookie-7a630560.js";import{u as k}from"./useMutation-3ec08b3e.js";import{u as C}from"./usePreventAccess-2bd80f40.js";const R="_interfaceWrapper_1eoef_1",W="_pickModal_1eoef_17",E="_registerForm_1eoef_87",L="_headingWrapper_1eoef_151",U="_textareaWrapper_1eoef_155",i={interfaceWrapper:R,pickModal:W,registerForm:E,headingWrapper:L,textareaWrapper:U},F="/";async function A(s){s.phoneNumber===""?s.phoneNumber=void 0:s.phoneNumber;try{return await(await fetch(`${F}api/auth/user/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json()}catch(n){throw new Error(n)}}async function q(s){s.phoneNumber===""?s.phoneNumber=void 0:s.phoneNumber;try{return await(await fetch(`${F}api/auth/agency/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json()}catch(n){throw new Error(n)}}function B(){const s=h(),{mutate:n,isLoading:r}=k({mutationFn:a=>A(a),onSuccess:a=>{a.status==="success"&&(N(a.token),d.success(a.message),s("/app")),a.status==="fail"&&d.error(a.message)},onError:a=>d.error(a.message)});return{mutate:n,isLoading:r}}function I(){var t,o,c,l;const{register:s,handleSubmit:n,formState:{errors:r}}=v(),{mutate:a,isLoading:m}=B();return m?e.jsx(u,{}):e.jsxs("form",{className:i.registerForm,onSubmit:n(p=>a(p)),children:[e.jsxs("div",{className:i.headingWrapper,children:[e.jsx("h2",{children:"Registracija"}),e.jsx("h3",{children:"Popunite lične podatke"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fullName",children:"Ime i Prezime"}),e.jsx("input",{type:"text",placeholder:"Novak Đoković",...s("fullName",{required:"Upišite ime i prezime"})}),((t=r.fullName)==null?void 0:t.message)&&e.jsxs("span",{children:[r.fullName.message," "]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",children:"Email adresa"}),e.jsx("input",{type:"email",placeholder:"novak@gmail.com",...s("email",{required:"Upišite vaš email!"})}),((o=r.email)==null?void 0:o.message)&&e.jsxs("span",{children:[r.email.message," "]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"location",children:"Lokacija stanovanja"}),e.jsx(y,{register:s})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{type:"password",placeholder:"*********",...s("password",{required:"Unesite vašu lozinku"})}),((c=r.password)==null?void 0:c.message)&&e.jsxs("span",{children:[r.password.message," "]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phoneNumber",children:"Broj telefona"}),e.jsx("input",{type:"number",placeholder:"+3876123456",...s("phoneNumber")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"passwordConfirm",children:"Ponovite password"}),e.jsx("input",{type:"password",placeholder:"********",...s("passwordConfirm",{required:"Ponovite password!"})}),((l=r.passwordConfirm)==null?void 0:l.message)&&e.jsxs("span",{children:[r.passwordConfirm.message," "]})]}),e.jsxs("span",{children:["Već imate postojeći račun? ",e.jsx(w,{to:"/login",children:"Prijavi se"})]}),e.jsx("button",{children:"REGISTRUJ SE"})]})}function O(){const s=h(),{mutate:n,isLoading:r}=k({mutationFn:a=>q(a),onSuccess:a=>{a.status==="success"&&(N(a.token),d.success(a.message),s("/app")),a.status==="fail"&&d.error(a.message)}});return{mutate:n,isLoading:r}}function T(){var t,o,c,l,p,j,x,g,f,b;const{register:s,handleSubmit:n,formState:{errors:r}}=v(),{mutate:a,isLoading:m}=O();return m?e.jsx(u,{}):e.jsxs("form",{className:i.registerForm,onSubmit:n(P=>a(P)),children:[e.jsxs("div",{className:i.headingWrapper,children:[e.jsx("h2",{children:"Registracija agencije"}),e.jsx("h3",{children:"Popunite podatke"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"agencyName",children:"Ime agencije*"}),e.jsx("input",{type:"text",placeholder:"Novak Agency",name:"agencyName",id:"agencyName",...s("agencyName",{required:"Unesite ime agencije"})}),((t=r.agencyName)==null?void 0:t.message)&&e.jsx("span",{children:(o=r.agencyName)==null?void 0:o.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"contactPerson",children:"Kontakt osoba"}),e.jsx("input",{type:"text",placeholder:"Novak Kontakter",name:"contactPerson",id:"contactPerson",...s("contactPerson",{required:"Unesite ime kontakt osobe"})}),((c=r.contactPerson)==null?void 0:c.message)&&e.jsx("span",{children:(l=r.contactPerson)==null?void 0:l.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",children:"Email adresa agencije"}),e.jsx("input",{type:"email",placeholder:"novak@gmail.com",name:"email",id:"email",...s("email",{required:"Unesite email agencije"})}),((p=r.email)==null?void 0:p.message)&&e.jsx("span",{children:(j=r.email)==null?void 0:j.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"location",children:"Lokacija agencije*"}),e.jsx(y,{register:s})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsx("input",{type:"password",placeholder:"*********",name:"password",id:"password",...s("password",{required:"Unesite password"})}),((x=r.password)==null?void 0:x.message)&&e.jsx("span",{children:(g=r.password)==null?void 0:g.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phoneNumber",children:"Broj telefona agencije"}),e.jsx("input",{type:"number",placeholder:"+3876123456",name:"phoneNumber",id:"phoneNumber",...s("phoneNumber")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"passwordConfirm",children:"Ponovite password"}),e.jsx("input",{type:"password",placeholder:"********",name:"passwordConfirm",id:"passwordConfirm",...s("passwordConfirm",{required:"Ponovite password"})}),((f=r.passwordConfirm)==null?void 0:f.message)&&e.jsx("span",{children:(b=r.passwordConfirm)==null?void 0:b.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"website",children:"Website agencije"}),e.jsx("input",{type:"text",placeholder:"www.noleagency.com",name:"website",id:"website",...s("website")})]}),e.jsxs("div",{className:i.textareaWrapper,children:[e.jsx("label",{htmlFor:"about",children:"O agenciji"}),e.jsx("textarea",{name:"about",id:"about",...s("about")})]}),e.jsxs("span",{children:["Već imate postojeći račun? ",e.jsx(w,{to:"/login",children:"Prijavi se"})]}),e.jsx("button",{children:"REGISTRUJ SE"})]})}const J="_returnBtn_1ika7_1",M={returnBtn:J};function K({cb:s}){return e.jsx("button",{onClick:s,className:M.returnBtn,children:e.jsx(S,{})})}function Q(){const s=C(),[n,r]=_.useState(null),a=h();return s?e.jsx(u,{}):e.jsxs("div",{className:i.interfaceWrapper,children:[e.jsx(K,{cb:n?()=>r(null):()=>a("/")}),!n&&e.jsxs("div",{className:i.pickModal,children:[e.jsx("span",{children:"Registruj se kao"}),e.jsxs("div",{onClick:()=>r("agency"),children:[e.jsx("span",{children:"AGENCIJA"}),e.jsx("img",{src:"/agency.svg",alt:"agency briefcase"})]}),e.jsxs("div",{onClick:()=>r("user"),children:[e.jsx("span",{children:"KORISNIK"}),e.jsx("img",{src:"/user.svg",alt:"agency briefcase"})]})]}),n==="user"&&e.jsx(I,{}),n==="agency"&&e.jsx(T,{})]})}export{Q as default};
